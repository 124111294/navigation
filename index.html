<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>个人导航主页</title>
    <link rel="stylesheet" href="./xiny/fontawesome/css/all.min.css" />
    <link rel="icon" href="./xiny/favicon.ico" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        min-height: 100vh;
        background: linear-gradient(
          135deg,
          #2c3e50 0%,
          #b3dace 30%,
          #cce8db 60%,
          #e3f5ec 100%
        );
        background-attachment: fixed;
        transition: all 0.3s ease;
        overflow-x: hidden;
      }

      /* 背景图片 */
      .bg-image {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        z-index: -1;
        opacity: 0;
        transition: opacity 1s ease-in-out;
      }

      .bg-image.loaded {
        opacity: 1;
      }

      /* 加载动画 */
      .loading-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          135deg,
          #2c3e50 0%,
          #b3dace 30%,
          #cce8db 60%,
          #e3f5ec 100%
        );
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        transition: all 0.8s ease;
      }

      .loading-container.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .loading-spinner {
        width: 60px;
        height: 60px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-top: 3px solid #ffffff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }

      /* 主容器 */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease;
      }

      .container.visible {
        opacity: 1;
        transform: translateY(0);
      }

      /* 头部 */
      .header {
        text-align: center;
        margin-bottom: 2rem;
        color: white;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 300;
        margin-bottom: 0.5rem;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
        text-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
      }

      /* 搜索框 */
      .search-container {
        max-width: 600px;
        margin: 0 auto 3rem auto;
        position: relative;
      }

      .search-box {
        width: 100%;
        padding: 1rem 1.5rem 1rem 3rem;
        border: none;
        border-radius: 50px;
        background: rgba(0, 0, 0, 0.15);
        backdrop-filter: blur(3px);
        color: white;
        font-size: 1rem;
        outline: none;
        transition: all 0.3s ease;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }

      .search-box::placeholder {
        color: rgba(255, 255, 255, 0.7);
      }

      .search-box:focus {
        background: rgba(
          255,
          255,
          255,
          0.2
        ); /* 从 0.25 降低到 0.2 提高透明度 */
        transform: translateY(-2px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
      }

      .search-icon {
        position: absolute;
        left: 1.2rem;
        top: 50%;
        transform: translateY(-50%);
        color: rgba(255, 255, 255, 0.7);
        font-size: 1.1rem;
      }

      /* 分组容器 */
      .section {
        margin-bottom: 3rem;
      }

      .section-title {
        color: white;
        font-size: 1.5rem;
        font-weight: 500;
        margin-bottom: 1.5rem;
        text-align: center;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        position: relative;
      }

      .section-title::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 50%;
        transform: translateX(-50%);
        width: 50px;
        height: 2px;
        background: linear-gradient(90deg, transparent, white, transparent);
      }

      /* 卡片网格 */
      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 1.5rem;
        justify-content: center;
      }

      /* 卡片样式 */
      .card {
        background: rgba(0, 0, 0, 0.15); /* 从 0.3 降低到 0.15 提高透明度 */
        border-radius: 20px;
        padding: 1.5rem;
        text-decoration: none;
        color: white;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border: 1px solid rgba(255, 255, 255, 0.1); /* 从 0.2 降低到 0.1 */
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.05); /* 减少阴影强度 */
        position: relative;
        overflow: hidden;
        opacity: 0;
        transform: translateY(30px);
        animation: cardFadeIn 0.6s ease forwards;

        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
      }

      .card:nth-child(even) {
        animation-delay: 0.1s;
      }

      .card:nth-child(3n) {
        animation-delay: 0.2s;
      }

      @keyframes cardFadeIn {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.1),
          transparent
        );
        transition: left 0.5s ease;
      }

      .card:hover::before {
        left: 100%;
      }

      .card:hover {
        transform: translateY(-8px) scale(1.02);
        background: rgba(
          255,
          255,
          255,
          0.1
        ); /* 从 0.15 降低到 0.1 提高透明度 */
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
      }

      .card-icon {
        width: 50px;
        height: 50px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1rem;
        font-size: 1.5rem;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .card:hover .card-icon {
        transform: scale(1.1) rotateY(10deg);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .card-title {
        font-size: 1.2rem;
        font-weight: 500;
        margin-bottom: 0.5rem;
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
      }

      /* 隐藏卡片 */
      .card.hidden {
        display: none;
      }

      /* 无结果提示 */
      .no-results {
        text-align: center;
        color: white;
        font-size: 1.2rem;
        margin-top: 2rem;
        opacity: 0.8;
        display: none;
      }

      /* 响应式设计 */
      @media (max-width: 768px) {
        .container {
          padding: 1rem;
        }

        .header h1 {
          font-size: 2rem;
        }

        .cards-grid {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
          gap: 1rem;
        }

        .card {
          padding: 1.2rem;
        }

        .search-box {
          background: rgba(0, 0, 0, 0.1); /* 从 0.15 降低到 0.1 提高透明度 */
        }

        .search-icon {
          left: 1rem;
        }
      }

      @media (max-width: 480px) {
        .cards-grid {
          grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        }

        .header h1 {
          font-size: 1.8rem;
        }
      }

      /* 滚动条样式 */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.5);
      }

      .sk-chase {
        width: 40px;
        height: 40px;
        position: relative;
        animation: sk-chase 2.5s infinite linear both;
      }

      .sk-chase-dot {
        width: 100%;
        height: 100%;
        position: absolute;
        left: 0;
        top: 0;
        animation: sk-chase-dot 2s infinite ease-in-out both;
      }

      .sk-chase-dot:before {
        content: "";
        display: block;
        width: 25%;
        height: 25%;
        background-color: #fff;
        border-radius: 100%;
        animation: sk-chase-dot-before 2s infinite ease-in-out both;
      }

      .sk-chase-dot:nth-child(1) {
        animation-delay: -1.1s;
      }

      .sk-chase-dot:nth-child(2) {
        animation-delay: -1s;
      }

      .sk-chase-dot:nth-child(3) {
        animation-delay: -0.9s;
      }

      .sk-chase-dot:nth-child(4) {
        animation-delay: -0.8s;
      }

      .sk-chase-dot:nth-child(5) {
        animation-delay: -0.7s;
      }

      .sk-chase-dot:nth-child(6) {
        animation-delay: -0.6s;
      }

      .sk-chase-dot:nth-child(1):before {
        animation-delay: -1.1s;
      }

      .sk-chase-dot:nth-child(2):before {
        animation-delay: -1s;
      }

      .sk-chase-dot:nth-child(3):before {
        animation-delay: -0.9s;
      }

      .sk-chase-dot:nth-child(4):before {
        animation-delay: -0.8s;
      }

      .sk-chase-dot:nth-child(5):before {
        animation-delay: -0.7s;
      }

      .sk-chase-dot:nth-child(6):before {
        animation-delay: -0.6s;
      }

      @keyframes sk-chase {
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes sk-chase-dot {
        80%,
        100% {
          transform: rotate(360deg);
        }
      }

      @keyframes sk-chase-dot-before {
        50% {
          transform: scale(0.4);
        }

        100%,
        0% {
          transform: scale(1);
        }
      }
    </style>
  </head>

  <body>
    <div class="bg-image" id="bgImage"></div>

    <div class="loading-container" id="loadingContainer">
      <div class="sk-chase">
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
        <div class="sk-chase-dot"></div>
      </div>
    </div>

    <div class="container" id="mainContainer">
      <header class="header">
        <h1>个人导航中心</h1>
        <p>快速访问您的所有服务</p>
      </header>

      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input
          type="text"
          class="search-box"
          placeholder="搜索服务..."
          id="searchInput"
        />
      </div>

      <div id="content"></div>

      <div class="no-results" id="noResults">
        <i
          class="fas fa-search"
          style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5"
        ></i>
        <p>未找到匹配的服务</p>
      </div>
    </div>

    <script>
      let config = null;

      function setBackground() {
        const bgImage = document.getElementById("bgImage");
        const baseUrl =
          window.innerWidth <= 768
            ? "https://img-api.wuxie.de/acg/13/sp"
            : "https://img-api.wuxie.de/acg/13/sp";
        const imageUrl = `${baseUrl}&t=${Date.now()}`;

        bgImage.style.backgroundImage = `url(${imageUrl})`;
        bgImage.classList.add("loaded");
      }

      function fetchWithTimeout(url, timeout = 2000) {
        return Promise.race([
          fetch(url),
          new Promise((_, reject) =>
            setTimeout(() => reject(new Error("请求超时")), timeout)
          ),
        ]);
      }

      async function loadConfigWithRetries(url, maxRetries = 3) {
        for (let attempt = 1; attempt <= maxRetries; attempt++) {
          try {
            const res = await fetchWithTimeout(url, 2000);
            if (!res.ok) throw new Error(`状态码错误: ${res.status}`);
            return await res.json();
          } catch (err) {
            console.warn(`第 ${attempt} 次加载失败:`, err);
            if (attempt === maxRetries) throw err;
          }
        }
      }

      function showRetryCard() {
        const content = document.getElementById("content");
        content.innerHTML = `
            <div class="cards-grid">
                <div class="card" style="padding: 2rem;">
                    <div class="card-icon" style="background: #ff6666;">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="card-title">加载失败</div>
                    <p>请检查网络</p>
                </div>
            </div>
        `;
      }

      function createCard(item) {
        return `
                <a href="${
                  item.url
                }" class="card" target="_blank" data-name="${item.name.toLowerCase()}">
                    <div class="card-icon">
                        <i class="${item.icon}"></i>
                    </div>
                    <div class="card-title">${item.name}</div>
                </a>
            `;
      }

      function renderContent() {
        const content = document.getElementById("content");
        let html = "";

        Object.keys(config).forEach((sectionName) => {
          html += `
                    <div class="section">
                        <h2 class="section-title">${sectionName}</h2>
                        <div class="cards-grid">
                            ${config[sectionName].map(createCard).join("")}
                        </div>
                    </div>
                `;
        });

        content.innerHTML = html;
      }

      function setupSearch() {
        const searchInput = document.getElementById("searchInput");
        const noResults = document.getElementById("noResults");

        searchInput.addEventListener("input", function () {
          const query = this.value.toLowerCase().trim();
          const cards = document.querySelectorAll(".card");
          const sections = document.querySelectorAll(".section");
          let hasResults = false;

          if (query === "") {
            cards.forEach((card) => {
              card.classList.remove("hidden");
              card.style.display = "";
            });
            sections.forEach((section) => {
              section.style.display = "";
            });
            noResults.style.display = "none";
            return;
          }

          cards.forEach((card) => {
            const name = card.dataset.name;

            if (name.includes(query)) {
              card.classList.remove("hidden");
              card.style.display = "";
              hasResults = true;
            } else {
              card.classList.add("hidden");
              card.style.display = "none";
            }
          });

          sections.forEach((section) => {
            const visibleCards = section.querySelectorAll(".card:not(.hidden)");
            section.style.display = visibleCards.length > 0 ? "" : "none";
          });

          noResults.style.display = hasResults ? "none" : "block";
        });
      }

      async function init() {
        setBackground();

        try {
          //   const configPromise = loadConfigWithRetries(
          //     `navigation.json?t=${Date.now()}`
          //   );
          //   const domReadyPromise = new Promise((resolve) => {
          //     if (document.readyState === "loading") {
          //       document.addEventListener("DOMContentLoaded", resolve);
          //     } else {
          //       resolve();
          //     }
          //   });

          //   const [loadedConfig] = await Promise.all([
          //     configPromise,
          //     domReadyPromise,
          //   ]);

          //   config = loadedConfig;

          // 等待 DOM 加载完成
          await new Promise((resolve) => {
            if (document.readyState === "loading") {
              document.addEventListener("DOMContentLoaded", resolve);
            } else {
              resolve();
            }
          });
          renderContent();
          setupSearch();
        } catch (err) {
          console.error("加载配置失败:", err);
          //   await new Promise((resolve) => {
          //     if (document.readyState === "loading") {
          //       document.addEventListener("DOMContentLoaded", resolve);
          //     } else {
          //       resolve();
          //     }
          //   });
          showRetryCard();
        } finally {
          setTimeout(() => {
            document.getElementById("loadingContainer").classList.add("hidden");
            document.getElementById("mainContainer").classList.add("visible");
          }, 500);
        }
      }

      init();

      config = {
        网站服务: [
          {
            name: "博客",
            url: "./bolg/index.html",
            icon: "fa-brands fa-blogger",
          },
          {
            name: "云盘",
            url: "https://ipgg.cn/",
            icon: "fa-brands fa-cloudflare",
          },
          {
            name: "状态",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-chart-column",
          },
          {
            name: "Jellyfin",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-film",
          },
          {
            name: "IP地址检测",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-globe",
          },
          {
            name: "IPV6测试",
            url: "https://v6test.ipgg.cn/",
            icon: "fa-solid fa-sliders",
          },
          {
            name: "工具",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-screwdriver-wrench",
          },
          {
            name: "SSH",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-terminal",
          },
          {
            name: "搜索",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-magnifying-glass",
          },
          {
            name: "图床",
            url: "https://ipgg.cn/",
            icon: "fa-brands fa-cloudflare",
          },
          {
            name: "文件快递柜",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-file-arrow-up",
          },
          {
            name: "HomeAssistant",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-house",
          },
          {
            name: "远程浏览器",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-globe",
          },
          {
            name: "Tcping节点",
            url: "https://tcping.wuxie.de/",
            icon: "fa-solid fa-network-wired",
          },
          {
            name: "剩余价值计算",
            url: "https://surplus.wuxie.de/",
            icon: "fa-solid fa-coins",
          },
          {
            name: "流量消耗",
            url: "https://use.wuxie.de/",
            icon: "fa-solid fa-tachometer-alt",
          },
          {
            name: "Wallos",
            url: "https://wallos.wuxie.de/",
            icon: "fa-brands fa-windows",
          },
          {
            name: "人工智能",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-robot",
          },
          {
            name: "比特彗星",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-bitcoin-sign",
          },
          {
            name: "Vertex",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-bitcoin-sign",
          },
          {
            name: "服务监控",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-server",
          },
          {
            name: "PDF工具",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-file-pdf",
          },
          {
            name: "2FA工具",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-key",
          },
          {
            name: "恋爱主页",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-flag",
          },
          {
            name: "网站统计",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-chart-line",
          },
          {
            name: "摄影作品",
            url: "https://tuchong.com/28030584/",
            icon: "fa-solid fa-camera-retro",
          },
        ],
        穿透服务: [
          {
            name: "OpenWrt",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-network-wired",
          },
          {
            name: "云盘",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-cloud",
          },
          {
            name: "影 视 库 ",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-film",
          },
          {
            name: "Aria2",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-download",
          },
          {
            name: "青龙面板",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-list-check",
          },
          {
            name: "PVE管理",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-server",
          },
          {
            name: "Docker管理",
            url: "https://ipgg.cn/",
            icon: "fa-brands fa-docker",
          },
          {
            name: "服务监控",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-heart-pulse",
          },
          {
            name: "原神",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-screwdriver-wrench",
          },
          {
            name: "家居智能",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-house",
          },
        ],
        内网服务: [
          {
            name: "OpenWrt",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-network-wired",
          },
          {
            name: "云盘",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-cloud",
          },
          {
            name: "影视库",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-film",
          },
          {
            name: "Aria2",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-download",
          },
          {
            name: "青龙面板",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-list-check",
          },
          {
            name: "PVE管理",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-server",
          },
          {
            name: "Docker管理",
            url: "https://ipgg.cn/",
            icon: "fa-brands fa-docker",
          },
          {
            name: "服务监控",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-heart-pulse",
          },
          {
            name: "原神",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-screwdriver-wrench",
          },
          {
            name: "家居智能",
            url: "https://ipgg.cn/",
            icon: "fa-solid fa-house",
          },
        ],
      };
    </script>
  </body>
</html>
